# ç»ˆç«¯å‘½ä»¤ç›‘å¬åŠŸèƒ½å¯è¡Œæ€§åˆ†æ

## ğŸ“‹ é—®é¢˜æ¦‚è¿°

**å½“å‰è¡Œä¸ºï¼š**
- âœ… é€šè¿‡æ‰©å±•ä¾§è¾¹æ æ‰§è¡Œçš„è„šæœ¬ä¼šè¢«è®°å½•åˆ°"æœ€è¿‘æ‰§è¡Œ"å†å²ä¸­
- âŒ ç›´æ¥åœ¨ç»ˆç«¯ä¸­æ‰‹åŠ¨è¾“å…¥å¹¶æ‰§è¡Œçš„å‘½ä»¤ä¸ä¼šè¢«è®°å½•

**ç”¨æˆ·æœŸæœ›ï¼š**
ç†æƒ³æƒ…å†µä¸‹ï¼Œ"æœ€è¿‘æ‰§è¡Œ"åº”è¯¥èƒ½å¤Ÿæ•è·å¹¶è®°å½•ç”¨æˆ·åœ¨ç»ˆç«¯ä¸­æ‰‹åŠ¨æ‰§è¡Œçš„ç›¸å…³å‘½ä»¤ï¼ˆå¦‚ npm/pnpm/yarn è„šæœ¬å‘½ä»¤ã€git å‘½ä»¤ç­‰ï¼‰ï¼Œä»¥æä¾›æ›´å®Œæ•´çš„æ‰§è¡Œå†å²ã€‚

---

## ğŸ” æŠ€æœ¯å¯è¡Œæ€§åˆ†æ

### 1. VS Code Terminal API èƒ½åŠ›è°ƒç ”

ç»è¿‡å¯¹ VS Code Extension API çš„æ·±å…¥ç ”ç©¶ï¼Œå‘ç°ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š

#### âŒ **å·²åºŸå¼ƒçš„ API**
- `vscode.window.onDidWriteTerminalData` - **å·²åœ¨ VS Code 1.39 ç‰ˆæœ¬ä¸­ç§»é™¤**
- `Terminal.onDidWriteData` - **å·²åºŸå¼ƒï¼Œä¸å¯ç”¨äºå‘å¸ƒçš„æ‰©å±•**

#### âœ… **å¯ç”¨çš„ Terminal API**

**1. Shell Integration APIï¼ˆæ¨èæ–¹æ¡ˆï¼‰**

VS Code æä¾›äº†å¼ºå¤§çš„ Shell Integration åŠŸèƒ½ï¼Œå¯ä»¥ç›‘å¬ç»ˆç«¯ä¸­çš„å‘½ä»¤æ‰§è¡Œï¼š

```typescript
// ç›‘å¬ Shell Integration æ¿€æ´»
window.onDidChangeTerminalShellIntegration((event) => {
    const { terminal, shellIntegration } = event;
    console.log(`Shell integration activated for terminal: ${terminal.name}`);
});

// ç›‘å¬å‘½ä»¤å¼€å§‹æ‰§è¡Œ
window.onDidStartTerminalShellExecution((event) => {
    const { execution, terminal } = event;
    const commandLine = execution.commandLine.value;
    const confidence = execution.commandLine.confidence;
    const isTrusted = execution.commandLine.isTrusted;
    
    console.log(`Command started: ${commandLine}`);
    console.log(`Confidence: ${confidence}`);
    console.log(`Trusted: ${isTrusted}`);
});

// ç›‘å¬å‘½ä»¤æ‰§è¡Œç»“æŸ
window.onDidEndTerminalShellExecution((event) => {
    const { execution, exitCode, terminal } = event;
    const commandLine = execution.commandLine.value;
    
    console.log(`Command ended: ${commandLine}`);
    console.log(`Exit code: ${exitCode}`);
});
```

**å…³é”®ç‰¹æ€§ï¼š**
- âœ… å¯ä»¥è·å–å®Œæ•´çš„å‘½ä»¤è¡Œæ–‡æœ¬
- âœ… å¯ä»¥è·å–å‘½ä»¤çš„é€€å‡ºç 
- âœ… å¯ä»¥è·å–å‘½ä»¤çš„æ‰§è¡Œæ—¶é—´
- âœ… å¯ä»¥è·å–å‘½ä»¤çš„å·¥ä½œç›®å½•ï¼ˆcwdï¼‰
- âœ… æ”¯æŒå‘½ä»¤ç½®ä¿¡åº¦ï¼ˆConfidenceï¼‰åˆ¤æ–­
- âœ… æ”¯æŒå¯ä¿¡å‘½ä»¤ï¼ˆTrustedï¼‰åˆ¤æ–­

**2. Terminal åŸºç¡€äº‹ä»¶**

```typescript
// ç›‘å¬ç»ˆç«¯åˆ›å»º
window.onDidOpenTerminal((terminal) => {
    console.log(`Terminal opened: ${terminal.name}`);
});

// ç›‘å¬ç»ˆç«¯å…³é—­
window.onDidCloseTerminal((terminal) => {
    console.log(`Terminal closed: ${terminal.name}`);
});

// ç›‘å¬æ´»åŠ¨ç»ˆç«¯å˜åŒ–
window.onDidChangeActiveTerminal((terminal) => {
    console.log(`Active terminal changed: ${terminal?.name}`);
});

// ç›‘å¬ç»ˆç«¯çŠ¶æ€å˜åŒ–
window.onDidChangeTerminalState((terminal) => {
    console.log(`Terminal state changed: ${terminal.name}`);
    console.log(`Is interacted with: ${terminal.state.isInteractedWith}`);
});
```

**3. Pseudoterminal APIï¼ˆè‡ªå®šä¹‰ç»ˆç«¯ï¼‰**

å¦‚æœéœ€è¦å®Œå…¨æ§åˆ¶ç»ˆç«¯çš„è¾“å…¥è¾“å‡ºï¼Œå¯ä»¥ä½¿ç”¨ Pseudoterminalï¼š

```typescript
const writeEmitter = new vscode.EventEmitter<string>();
const pty: vscode.Pseudoterminal = {
    onDidWrite: writeEmitter.event,
    open: () => writeEmitter.fire('Custom terminal ready\r\n'),
    close: () => {},
    handleInput: (data: string) => {
        // æ•è·ç”¨æˆ·è¾“å…¥
        console.log('User input:', data);
        writeEmitter.fire(data);
    }
};

const terminal = vscode.window.createTerminal({ name: 'Custom Terminal', pty });
```

---

### 2. Shell Integration çš„é™åˆ¶å’Œè¦æ±‚

#### âœ… **ä¼˜åŠ¿ï¼š**
1. **å®˜æ–¹æ”¯æŒ**ï¼šè¿™æ˜¯ VS Code å®˜æ–¹æ¨èçš„ç»ˆç«¯å‘½ä»¤ç›‘å¬æ–¹æ¡ˆ
2. **å‡†ç¡®æ€§é«˜**ï¼šå¯ä»¥å‡†ç¡®è·å–å‘½ä»¤è¡Œã€é€€å‡ºç ã€å·¥ä½œç›®å½•ç­‰ä¿¡æ¯
3. **æ€§èƒ½å¥½**ï¼šä¸éœ€è¦è§£æç»ˆç«¯è¾“å‡ºï¼Œç›´æ¥ä» shell è·å–ç»“æ„åŒ–æ•°æ®
4. **å®‰å…¨æ€§**ï¼šæ”¯æŒå‘½ä»¤å¯ä¿¡åº¦éªŒè¯ï¼ˆnonceï¼‰

#### âŒ **é™åˆ¶ï¼š**
1. **éœ€è¦ Shell Integration æ¿€æ´»**ï¼š
   - ç”¨æˆ·çš„ shell å¿…é¡»æ”¯æŒ shell integration
   - æ”¯æŒçš„ shellï¼šbash, zsh, fish, pwsh (PowerShell)
   - **ä¸æ”¯æŒ**ï¼šCommand Prompt (cmd.exe)
   - ç”¨æˆ·çš„ shell é…ç½®å¯èƒ½ä¸è‡ªåŠ¨æ¿€æ´»å†²çª

2. **æ¿€æ´»æ—¶æœºä¸ç¡®å®š**ï¼š
   - Shell integration ä¸æ˜¯ç«‹å³æ¿€æ´»çš„
   - å¯èƒ½åœ¨ç»ˆç«¯åˆ›å»ºåå‡ ç§’æ‰æ¿€æ´»
   - æŸäº›ç»ˆç«¯å¯èƒ½æ°¸è¿œä¸ä¼šæ¿€æ´»

3. **åªèƒ½ç›‘å¬æ¿€æ´»åçš„å‘½ä»¤**ï¼š
   - åœ¨ shell integration æ¿€æ´»ä¹‹å‰æ‰§è¡Œçš„å‘½ä»¤æ— æ³•æ•è·
   - éœ€è¦ç­‰å¾… `onDidChangeTerminalShellIntegration` äº‹ä»¶

4. **ç”¨æˆ·åˆ›å»ºçš„ç»ˆç«¯**ï¼š
   - åªèƒ½ç›‘å¬ç”¨æˆ·åœ¨ VS Code ä¸­åˆ›å»ºçš„ç»ˆç«¯
   - æ— æ³•ç›‘å¬å¤–éƒ¨ç»ˆç«¯æˆ–å…¶ä»–åº”ç”¨çš„ç»ˆç«¯

---

### 3. å®ç°æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | ä¼˜åŠ¿ | åŠ£åŠ¿ | æ¨èåº¦ |
|------|------|------|--------|
| **Shell Integration API** | â€¢ å®˜æ–¹æ”¯æŒ<br>â€¢ å‡†ç¡®æ€§é«˜<br>â€¢ æ€§èƒ½å¥½<br>â€¢ å¯è·å–é€€å‡ºç  | â€¢ éœ€è¦ shell æ”¯æŒ<br>â€¢ æ¿€æ´»æ—¶æœºä¸ç¡®å®š<br>â€¢ æŸäº› shell ä¸æ”¯æŒ | â­â­â­â­â­ |
| **Pseudoterminal** | â€¢ å®Œå…¨æ§åˆ¶<br>â€¢ å¯æ•è·æ‰€æœ‰è¾“å…¥ | â€¢ éœ€è¦æ›¿æ¢ç”¨æˆ·ç»ˆç«¯<br>â€¢ ç”¨æˆ·ä½“éªŒå·®<br>â€¢ å®ç°å¤æ‚ | â­â­ |
| **Terminal State ç›‘å¬** | â€¢ ç®€å•<br>â€¢ æ— éœ€ shell æ”¯æŒ | â€¢ æ— æ³•è·å–å‘½ä»¤å†…å®¹<br>â€¢ åªèƒ½çŸ¥é“æ˜¯å¦äº¤äº’ | â­ |
| **å·²åºŸå¼ƒçš„ API** | - | â€¢ å·²ç§»é™¤<br>â€¢ ä¸å¯ç”¨ | âŒ |

---

## ğŸ’¡ æ¨èå®ç°æ–¹æ¡ˆ

### æ–¹æ¡ˆï¼šShell Integration + é™çº§å¤„ç†

**æ ¸å¿ƒæ€è·¯ï¼š**
1. ä¼˜å…ˆä½¿ç”¨ Shell Integration API ç›‘å¬å‘½ä»¤æ‰§è¡Œ
2. å¯¹äºä¸æ”¯æŒçš„ç»ˆç«¯ï¼Œæä¾›é™çº§æ–¹æ¡ˆï¼ˆä»…è®°å½•æ‰©å±•æ‰§è¡Œçš„å‘½ä»¤ï¼‰
3. å‘ç”¨æˆ·æä¾›æ¸…æ™°çš„åŠŸèƒ½è¯´æ˜å’Œé™åˆ¶æç¤º

**å®ç°æ­¥éª¤ï¼š**

#### 1. åˆ›å»º Terminal Monitor æ¨¡å—

```typescript
// src/terminalMonitor.ts
import * as vscode from 'vscode';
import { HistoryManager } from './historyManager';
import { NpmScriptManager } from './npmScriptManager';

export class TerminalMonitor {
    private disposables: vscode.Disposable[] = [];
    private monitoredTerminals = new Set<vscode.Terminal>();

    constructor(
        private historyManager: HistoryManager,
        private npmScriptManager: NpmScriptManager
    ) {
        this.initialize();
    }

    private initialize(): void {
        // ç›‘å¬ Shell Integration æ¿€æ´»
        this.disposables.push(
            vscode.window.onDidChangeTerminalShellIntegration((event) => {
                this.onShellIntegrationActivated(event);
            })
        );

        // ç›‘å¬å‘½ä»¤æ‰§è¡Œå¼€å§‹
        this.disposables.push(
            vscode.window.onDidStartTerminalShellExecution((event) => {
                this.onCommandStarted(event);
            })
        );

        // ç›‘å¬å‘½ä»¤æ‰§è¡Œç»“æŸ
        this.disposables.push(
            vscode.window.onDidEndTerminalShellExecution((event) => {
                this.onCommandEnded(event);
            })
        );

        // ç›‘å¬ç»ˆç«¯å…³é—­
        this.disposables.push(
            vscode.window.onDidCloseTerminal((terminal) => {
                this.monitoredTerminals.delete(terminal);
            })
        );
    }

    private onShellIntegrationActivated(
        event: vscode.TerminalShellIntegrationChangeEvent
    ): void {
        const { terminal, shellIntegration } = event;
        
        if (!this.monitoredTerminals.has(terminal)) {
            this.monitoredTerminals.add(terminal);
            console.log(`[TerminalMonitor] Shell integration activated for: ${terminal.name}`);
        }
    }

    private onCommandStarted(
        event: vscode.TerminalShellExecutionStartEvent
    ): void {
        const { execution, terminal } = event;
        const commandLine = execution.commandLine.value;
        
        console.log(`[TerminalMonitor] Command started: ${commandLine}`);
    }

    private onCommandEnded(
        event: vscode.TerminalShellExecutionEndEvent
    ): void {
        const { execution, exitCode, terminal } = event;
        const commandLine = execution.commandLine.value;
        const confidence = execution.commandLine.confidence;
        
        console.log(`[TerminalMonitor] Command ended: ${commandLine}`);
        console.log(`[TerminalMonitor] Exit code: ${exitCode}`);
        console.log(`[TerminalMonitor] Confidence: ${confidence}`);

        // è§£æå¹¶è®°å½•ç›¸å…³å‘½ä»¤
        this.parseAndRecordCommand(commandLine, exitCode, terminal);
    }

    private parseAndRecordCommand(
        commandLine: string,
        exitCode: number | undefined,
        terminal: vscode.Terminal
    ): void {
        // è§£æå‘½ä»¤ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯ npm/pnpm/yarn/git å‘½ä»¤
        const trimmedCommand = commandLine.trim();
        
        // æ£€æŸ¥æ˜¯å¦æ˜¯åŒ…ç®¡ç†å™¨è„šæœ¬å‘½ä»¤
        const scriptMatch = this.matchScriptCommand(trimmedCommand);
        if (scriptMatch) {
            this.recordScriptExecution(scriptMatch);
            return;
        }

        // æ£€æŸ¥æ˜¯å¦æ˜¯ Git å‘½ä»¤
        const gitMatch = this.matchGitCommand(trimmedCommand);
        if (gitMatch) {
            this.recordGitExecution(gitMatch);
            return;
        }
    }

    private matchScriptCommand(command: string): { 
        packageManager: string; 
        scriptName: string; 
        packageJsonPath: string;
    } | null {
        // åŒ¹é… npm run xxx, pnpm xxx, yarn xxx ç­‰
        const patterns = [
            /^npm\s+run\s+([^\s]+)/,
            /^pnpm\s+([^\s]+)/,
            /^yarn\s+([^\s]+)/,
            /^yarn\s+run\s+([^\s]+)/
        ];

        for (const pattern of patterns) {
            const match = command.match(pattern);
            if (match) {
                const scriptName = match[1];
                // æŸ¥æ‰¾å¯¹åº”çš„ NpmScript
                const script = this.findScriptByName(scriptName);
                if (script) {
                    return {
                        packageManager: this.detectPackageManager(command),
                        scriptName,
                        packageJsonPath: script.packageJsonPath
                    };
                }
            }
        }

        return null;
    }

    private matchGitCommand(command: string): { command: string } | null {
        if (command.startsWith('git ')) {
            return { command };
        }
        return null;
    }

    private findScriptByName(scriptName: string): any {
        // ä» npmScriptManager ä¸­æŸ¥æ‰¾è„šæœ¬
        const allScripts = this.npmScriptManager.getAllScripts();
        return allScripts.find(script => script.name === scriptName);
    }

    private detectPackageManager(command: string): string {
        if (command.startsWith('npm ')) return 'npm';
        if (command.startsWith('pnpm ')) return 'pnpm';
        if (command.startsWith('yarn ')) return 'yarn';
        return 'unknown';
    }

    private recordScriptExecution(match: { 
        packageManager: string; 
        scriptName: string; 
        packageJsonPath: string;
    }): void {
        const script = this.findScriptByName(match.scriptName);
        if (script) {
            this.historyManager.addToHistory(script);
            console.log(`[TerminalMonitor] Recorded script execution: ${match.scriptName}`);
        }
    }

    private recordGitExecution(match: { command: string }): void {
        // å¯ä»¥æ‰©å±•è®°å½• Git å‘½ä»¤å†å²
        console.log(`[TerminalMonitor] Git command executed: ${match.command}`);
    }

    dispose(): void {
        this.disposables.forEach(d => d.dispose());
        this.monitoredTerminals.clear();
    }
}
```

#### 2. åœ¨ extension.ts ä¸­é›†æˆ

```typescript
// src/extension.ts
import { TerminalMonitor } from './terminalMonitor';

export function activate(context: vscode.ExtensionContext) {
    // ... ç°æœ‰ä»£ç  ...

    // åˆ›å»º Terminal Monitorï¼ˆå¯é€‰åŠŸèƒ½ï¼‰
    const enableTerminalMonitoring = vscode.workspace
        .getConfiguration('scriptButler')
        .get<boolean>('enableTerminalMonitoring', false);

    if (enableTerminalMonitoring) {
        const terminalMonitor = new TerminalMonitor(historyManager, npmScriptManager);
        context.subscriptions.push(terminalMonitor);
    }

    // ... ç°æœ‰ä»£ç  ...
}
```

#### 3. æ·»åŠ é…ç½®é¡¹

```json
// package.json
{
  "contributes": {
    "configuration": {
      "title": "è„šæœ¬ç®¡å®¶",
      "properties": {
        "scriptButler.enableTerminalMonitoring": {
          "type": "boolean",
          "default": false,
          "description": "å¯ç”¨ç»ˆç«¯å‘½ä»¤ç›‘å¬åŠŸèƒ½ï¼ˆå®éªŒæ€§ï¼‰ã€‚éœ€è¦ Shell Integration æ”¯æŒï¼Œä»…é€‚ç”¨äº bash/zsh/fish/pwshã€‚"
        }
      }
    }
  }
}
```

---

## âš ï¸ åŠŸèƒ½é™åˆ¶å’Œæ³¨æ„äº‹é¡¹

### 1. Shell å…¼å®¹æ€§

| Shell | æ”¯æŒçŠ¶æ€ | è¯´æ˜ |
|-------|---------|------|
| bash | âœ… æ”¯æŒ | éœ€è¦ VS Code è‡ªåŠ¨æ³¨å…¥çš„ shell integration è„šæœ¬ |
| zsh | âœ… æ”¯æŒ | éœ€è¦ VS Code è‡ªåŠ¨æ³¨å…¥çš„ shell integration è„šæœ¬ |
| fish | âœ… æ”¯æŒ | éœ€è¦ VS Code è‡ªåŠ¨æ³¨å…¥çš„ shell integration è„šæœ¬ |
| pwsh (PowerShell) | âœ… æ”¯æŒ | éœ€è¦ VS Code è‡ªåŠ¨æ³¨å…¥çš„ shell integration è„šæœ¬ |
| cmd.exe | âŒ ä¸æ”¯æŒ | Command Prompt ä¸æ”¯æŒ shell integration |
| Git Bash | âš ï¸ éƒ¨åˆ†æ”¯æŒ | å–å†³äºé…ç½® |

### 2. ç”¨æˆ·ä½“éªŒè€ƒè™‘

**ä¼˜ç‚¹ï¼š**
- âœ… æä¾›æ›´å®Œæ•´çš„æ‰§è¡Œå†å²
- âœ… æ— éœ€ç”¨æˆ·æ‰‹åŠ¨æ“ä½œ
- âœ… è‡ªåŠ¨è¯†åˆ«ç›¸å…³å‘½ä»¤

**ç¼ºç‚¹ï¼š**
- âŒ ä¸æ˜¯æ‰€æœ‰ç»ˆç«¯éƒ½æ”¯æŒ
- âŒ å¯èƒ½æœ‰å»¶è¿Ÿï¼ˆç­‰å¾… shell integration æ¿€æ´»ï¼‰
- âŒ æŸäº›ç”¨æˆ·é…ç½®å¯èƒ½å¯¼è‡´åŠŸèƒ½å¤±æ•ˆ

### 3. æ€§èƒ½å½±å“

- **CPU ä½¿ç”¨**ï¼šæä½ï¼ˆä»…äº‹ä»¶ç›‘å¬å’Œç®€å•å­—ç¬¦ä¸²åŒ¹é…ï¼‰
- **å†…å­˜ä½¿ç”¨**ï¼šæä½ï¼ˆä»…å­˜å‚¨å°‘é‡äº‹ä»¶ç›‘å¬å™¨ï¼‰
- **I/O å½±å“**ï¼šæ— ï¼ˆä¸æ¶‰åŠæ–‡ä»¶è¯»å†™ï¼‰

---

## ğŸ“Š æœ€ç»ˆå»ºè®®

### âœ… **å»ºè®®å®ç°ï¼Œä½†ä½œä¸ºå¯é€‰åŠŸèƒ½**

**ç†ç”±ï¼š**
1. **æŠ€æœ¯å¯è¡Œ**ï¼šShell Integration API æ˜¯å®˜æ–¹æ”¯æŒçš„ç¨³å®š API
2. **ç”¨æˆ·ä»·å€¼**ï¼šå¯ä»¥æ˜¾è‘—æå‡ç”¨æˆ·ä½“éªŒï¼Œæä¾›æ›´å®Œæ•´çš„å†å²è®°å½•
3. **é£é™©å¯æ§**ï¼šä½œä¸ºå¯é€‰åŠŸèƒ½ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½
4. **é™çº§ä¼˜é›…**ï¼šä¸æ”¯æŒçš„ç¯å¢ƒä¸‹è‡ªåŠ¨é™çº§ï¼Œä¸ä¼šæŠ¥é”™

**å®æ–½å»ºè®®ï¼š**
1. **é»˜è®¤å…³é—­**ï¼šå°†æ­¤åŠŸèƒ½è®¾ä¸ºå¯é€‰ï¼Œé»˜è®¤å…³é—­
2. **æ¸…æ™°è¯´æ˜**ï¼šåœ¨è®¾ç½®ä¸­æ˜ç¡®è¯´æ˜åŠŸèƒ½é™åˆ¶å’Œè¦æ±‚
3. **çŠ¶æ€æç¤º**ï¼šåœ¨ UI ä¸­æ˜¾ç¤º shell integration çŠ¶æ€
4. **é™çº§å¤„ç†**ï¼šä¸æ”¯æŒæ—¶è‡ªåŠ¨é™çº§åˆ°ä»…è®°å½•æ‰©å±•æ‰§è¡Œçš„å‘½ä»¤

**é…ç½®å»ºè®®ï¼š**
```json
{
  "scriptButler.enableTerminalMonitoring": false,  // é»˜è®¤å…³é—­
  "scriptButler.terminalMonitoring.supportedCommands": [
    "npm",
    "pnpm",
    "yarn",
    "git"
  ]
}
```

**UI æç¤ºå»ºè®®ï¼š**
- åœ¨"æœ€è¿‘æ‰§è¡Œ"è§†å›¾ä¸­æ·»åŠ çŠ¶æ€æŒ‡ç¤ºå™¨
- æ˜¾ç¤º "ç»ˆç«¯ç›‘å¬: âœ… å·²å¯ç”¨ (2/3 ç»ˆç«¯æ”¯æŒ)" æˆ– "ç»ˆç«¯ç›‘å¬: âŒ æœªå¯ç”¨"
- æä¾›å¿«é€Ÿå¯ç”¨/ç¦ç”¨çš„æŒ‰é’®

---

## ğŸ“š å‚è€ƒèµ„æ–™

1. **VS Code Terminal API æ–‡æ¡£**ï¼š
   - https://code.visualstudio.com/api/references/vscode-api#window
   - Shell Integration Events

2. **ç›¸å…³ GitHub Issues**ï¼š
   - [Terminal.onDidWriteData deprecated](https://github.com/microsoft/vscode/issues/...)
   - [Shell Integration API finalized in v1.39](https://code.visualstudio.com/updates/v1_39)

3. **Stack Overflow è®¨è®º**ï¼š
   - [Alternative of vscode.window.onDidWriteTerminalData](https://stackoverflow.com/questions/71894392/)

---

## ğŸ¯ æ€»ç»“

**ç»ˆç«¯å‘½ä»¤ç›‘å¬åŠŸèƒ½æ˜¯æŠ€æœ¯å¯è¡Œçš„ï¼Œå»ºè®®ä½œä¸ºå¯é€‰çš„å®éªŒæ€§åŠŸèƒ½å®ç°ã€‚**

é€šè¿‡ Shell Integration APIï¼Œæˆ‘ä»¬å¯ä»¥å‡†ç¡®åœ°æ•è·ç”¨æˆ·åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¹¶å°†ç›¸å…³çš„ npm/pnpm/yarn/git å‘½ä»¤è®°å½•åˆ°"æœ€è¿‘æ‰§è¡Œ"å†å²ä¸­ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›é™åˆ¶ï¼ˆå¦‚ shell å…¼å®¹æ€§ã€æ¿€æ´»æ—¶æœºç­‰ï¼‰ï¼Œä½†é€šè¿‡åˆç†çš„è®¾è®¡ï¼ˆé»˜è®¤å…³é—­ã€æ¸…æ™°è¯´æ˜ã€é™çº§å¤„ç†ï¼‰ï¼Œå¯ä»¥ä¸ºæ”¯æŒçš„ç”¨æˆ·æä¾›æ˜¾è‘—çš„ä»·å€¼æå‡ï¼ŒåŒæ—¶ä¸å½±å“ä¸æ”¯æŒçš„ç”¨æˆ·ã€‚

